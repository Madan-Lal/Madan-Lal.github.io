function getAngle(e){var t=e/2400;return t>1&&(t=1),Math.round(60-60*t+.1)}function redraw(){var e,t=parseInt(document.body.clientWidth),r=spacey=0;if(t>2300?t=2300:1100>t&&(t=1100),d=getAngle(t),t>=1100&&2300<=t)for(r=(t-1030)/(CARDS-2),1150>t&&(spacey=75*(1150-t)/52),i=1;i<CARDS;i++)e=document.getElementById("f1_"+i),e.style.left=425+r*(i-1)+"px",e.style.top=20+spacey*(i-1)+"px",0==flat&&(e.style.MozTransform=e.style.webkitTransform="perspective(800px) rotateY("+d+"deg)")}function flatten(e){if(e)for(card=document.getElementById("f1_"+e),"perspective(800px) rotateY(0deg)"==card.style.webkitTransform||"perspective(800px) rotateY(0deg)"==card.style.MozTransform?(card.style.MozTransform=card.style.webkitTransform="perspective(800px) rotateY(0deg) translateZ(120px)",card.style.MozFilter=card.style.webkitFilter="saturate(100%) opacity(100%)",doProgress(e,1)):flat&&(card.style.MozTransform=card.style.webkitTransform="perspective(800px) rotateY(0deg)",card.style.MozFilter=card.style.webkitFilter="saturate(0%) opacity(50%)",doProgress(e,0)),card.style.webkitTransform=="perspective(800px) rotateY("+d+"deg)"||card.style.MozTransform=="perspective(800px) rotateY("+d+"deg)"?(card.style.MozTransform=card.style.webkitTransform="perspective(800px) rotateY(0deg) translateZ(120px)",card.style.MozFilter=card.style.webkitFilter="saturate(100%) opacity(100%)",doProgress(e,1)):flat||(card.style.MozTransform=card.style.webkitTransform="perspective(800px) rotateY("+d+"deg)",card.style.MozFilter=card.style.webkitFilter="saturate(0%) opacity(50%)",doProgress(e,0)),i=1;i<CARDS;i++)i!=e&&(card=document.getElementById("f1_"+i),card.style.MozFilter=card.style.webkitFilter="saturate(0%) opacity(50%)",flat?card.style.MozTransform=card.style.webkitTransform="perspective(800px) rotateY(0deg)":card.style.MozTransform=card.style.webkitTransform="perspective(800px) rotateY("+d+"deg)");else{for(i=1;i<CARDS;i++)card=document.getElementById("f1_"+i),card.style.MozFilter=card.style.webkitFilter="saturate(0%) opacity(50%)",0==flat?card.style.MozTransform=card.style.webkitTransform="perspective(800px) rotateY(0deg)":card.style.MozTransform=card.style.webkitTransform="perspective(800px) rotateY("+d+"deg)";flat=!flat,ga("send","event","flatten","flatten_tracker","new_test")}}function calcProgress(e){var t=0,r=0;if(!hitMax&&dwell[e]!=MAX_TIME){for(r=(Date.now()-timeStart)/1e3,timeStart=Date.now(),dwell[e]+=r>minTime?r:0,dwell[e]=dwell[e]>MAX_TIME?MAX_TIME:dwell[e],i=1;i<CARDS;i++)t+=dwell[i];t/=MAX_TIME*(CARDS-1),renderProgress(Math.floor(100*t)),100==Math.floor(100*t)&&(hitMax=1),maxTimeID=setTimeout(calcProgress,300,e)}}function doProgress(e,t){if(t)timeStart=Date.now(),maxTimeID=setTimeout(calcProgress,500,e);else for(i=0;i<=maxTimeID;i++)clearTimeout(i)}function renderProgress(e){var t=0;if(25>e){var r=-90+e/100*360;$(".animate-0-25-b").css("transform","rotate("+r+"deg)")}else if(e>=25&&50>e){var r=-90+(e-25)/100*360;$(".animate-0-25-b").css("transform","rotate(0deg)"),$(".animate-25-50-b").css("transform","rotate("+r+"deg)")}else if(e>=50&&75>e){var r=-90+(e-50)/100*360;$(".animate-25-50-b, .animate-0-25-b").css("transform","rotate(0deg)"),$(".animate-50-75-b").css("transform","rotate("+r+"deg)")}else if(e>=75&&100>=e){var r=-90+(e-75)/100*360;$(".animate-50-75-b, .animate-25-50-b, .animate-0-25-b").css("transform","rotate(0deg)"),$(".animate-75-100-b").css("transform","rotate("+r+"deg)"),100==e&&(card=document.getElementById("name_fade"),card.style.visibility="visible")}t=Math.floor(255-160*e/100),$(".loader-spiner").css("border","10px solid rgba("+t+", 255,"+t+","+(.4*e/100+.3)+")"),e>lastProgress+10&&(ga("send","event","progress","reading_goal","new_test",e),lastProgress=e),$(".text").html(e+"%")}function start(){initEyes(),redraw()}var flat=0,d=60,CARDS=9,dwell=[0,0,0,0,0,0,0,0,0,0],timeStart=0,lastProgress=0,minTime=.2,MAX_TIME=4,maxTimeID,hitMax=0;$(document.body).removeClass("no_js");var doOnce=1;$(document).on("ready",function(){$(window).on("resize",function(){redraw(),doOnce&&(ga("send","event","resize","resize_tracker","new_test"),doOnce=0)}).trigger("resize")});
